CC = gcc
FLAGS = -Wall -Wextra -Werror -std=c11
TARGET = main
SRC = s21_strlen.c s21_strstr.c
TEST_LIBS = -lcheck -lm -lpthread -lsubunit
TEST_SRC = tests.c

$(TARGET):
	$(CC) $(FLAGS) $(SRC) -o $(TARGET)

test:
	$(CC) $(FLAGS) $(SRC) $(TEST_SRC) -I. $(TEST_LIBS) -o tests
	./tests

clean:
	rm -f $(TARGET) ./tests



# -I.: Указывает компилятору искать заголовочных файлов (файлов с расширением .h) в текущем каталоге (.). Это полезно, если ваши заголовочные файлы (s21_strstr.h) находятся в той же директории, что и исходные файлы .c.
# -lcheck: Сообщает компилятору (точнее, линковщику, который вызывается после компиляции) связать с вашей программой библиотеку libcheck. Библиотека check используется для написания и запуска юнит-тестов. Компилятор сам добавит -lcheck к имени библиотеки (libcheck.so или libcheck.a в зависимости от типа библиотеки).
# -lm: Сообщает линковщику связать с библиотекой libm (Math Library). Она содержит математические функции. Хотя для тестирования строк это не обязательно, иногда check или другие библиотеки могут использовать функции из libm.
# -lpthread: Сообщает линковщику связать с библиотекой libpthread (POSIX Threads). Библиотека check может использовать потоки для управления тестов, поэтому она может быть нужна. (Хотя -lcheck обычно включает -lpthread, явное указание не повредит).
# -lsubunit: Сообщает линковщику связать с библиотекой libsubunit. Это формат для передачи результатов тестов. Библиотека check имеет поддержку вывода результатов в формате Subunit. Этот флаг, скорее всего, является причиной ошибки, которую вы видите. Если библиотека check, которую вы установили, не была собрана с поддержкой Subunit, линковщик не сможет найти функции subunit_test_start, subunit_test_pass и т.д., и выдаст ошибку undefined reference. (Решение - см. предыдущий ответ).
# -o tests: Задает имя выходного исполняемого файла, который будет создан в результате компиляции и линковки. В данном случае это будет файл tests.
# Итог:

# Команда компилирует три исходных файла C (s21_strstr.c, s21_strlen.c, tests.c), использует стандарт C11, включает строгие предупреждений и преобразует их в ошибки. Она ищет заголовочные файлы в текущем каталоге и связывает полученную программу с библиотеками check, m, pthread и subunit, создавая исполняемый файл tests. Проблема, скорее всего, связана с флагом -lsubunit и версией/конфигурацией библиотеки check.